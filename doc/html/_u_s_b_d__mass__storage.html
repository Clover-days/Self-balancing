<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HT32F5xxxx Standard Peripheral Firmware Library: </title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HT32F5xxxx Standard Peripheral Firmware Library&#160;<span id="projectnumber">V1.9.1(7446)</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="page2.html">HT32F5xxxx Peripheral Examples</a>      </li>
    </ul>
  </div>
</div>
<div class="contents">
<div class="textblock"><div class="fragment"><pre class="fragment">
 * @file    USBD/Mass_Storage/readme.txt
 * @version V1.00
 * @date    2014-06-30
 * @brief   Description of USB Device Mass Storage example.
 </pre></div><dl class="user"><dt><b>Example Description:</b></dt><dd></dd></dl>
<p>The USB Device Mass Storage example code shows how to use HT32 USB Device Library, enumeration, and Endpoint bulk transfer. This example code communicates with PC host using the Bulk Only Transport (BOT) protocol. When the USB enumeration is finished, you can access RAM disk and SD Disk by windows file explorer. The example includes BOT, SCSI Block Command (SBC-3 and SPC-4), RAM and SD disk related function. The data flow of BOT is as below. </p>
<pre>
              ---------
              | Ready |   &lt;   -   -   -   |
              ---------
                  |                       |
              ---------
              |  CBW  |                   |
              ---------
          /       |       \               |
    -----------       ------------
    | DATA IN |   |   | DATA OUT |        |
    -----------       ------------
          \       |       /               |
              ---------
              |  CSW  |   -   -   -   -   |
              ---------</pre><pre>  Host                    Device
  ==========              ==========
  CBW            -&gt;       BOT -&gt; SBC
                          Process CBW command by BOT state machine and pass CB to SBC function.
  OUT(s)         -&gt;       BOT -&gt; SBC -&gt; DISK (RAM or SD)
                          Received data from Host and pass to SBC. Execute SBC command and write
                          data to disk if necessary.
  or</pre><pre>  IN(s)          &lt;-       BOT &lt;- SBC &lt;- DISK (RAM or SD)
                          Send data to Host according to the SBC command.
  CSW            &lt;-       Return CSW according to the SBC command result
</pre><dl class="user"><dt><b>Directory Contents:</b></dt><dd></dd></dl>
<ul>
<li>USBD/Mass_Storage/main.c Main program</li>
<li>USBD/Mass_Storage/ht32fxxxx_it.c Interrupt handlers</li>
<li>USBD/Mass_Storage/ht32fxxxx_conf.h Firmware library configuration file</li>
<li>USBD/Mass_Storage/system_ht32fxxxx.c System configuration file</li>
<li>USBD/Mass_Storage/ht32fxxxx_usbdconf.h USB Device Library configuration file</li>
<li>USBD/Mass_Storage/ht32_usbd_class.c USB Device Class related function</li>
<li><a class="el" href="example_2_u_s_b_d_2_mass___storage_2ht32__usbd__class_8h.html" title="The header file of USB Device Class.">USBD/Mass_Storage/ht32_usbd_class.h</a> Header file of the USB Device Class</li>
<li>USBD/Mass_Storage/ht32_usbd_descriptor.c Descriptor of USB Device</li>
<li><a class="el" href="example_2_u_s_b_d_2_mass___storage_2ht32__usbd__descriptor_8h.html" title="The USB descriptor.">USBD/Mass_Storage/ht32_usbd_descriptor.h</a> Header file of the USB Device Descriptor</li>
<li>USBD/Mass_Storage/usb_bulk_only_transport.c Bulk only transport (BOT) related functions</li>
<li><a class="el" href="_mass___storage_2usb__bulk__only__transport_8h.html" title="The header file of Bulk Only Transport.">USBD/Mass_Storage/usb_bulk_only_transport.h</a> Header file of BOT</li>
<li>USBD/Mass_Storage/usb_scsi_block_command.c SCSI Block Command (SBC-3 and SPC-4)</li>
<li><a class="el" href="_mass___storage_2usb__scsi__block__command_8h.html" title="The header file of SCSI Block Command (SBC-3 &amp; SPC-4).">USBD/Mass_Storage/usb_scsi_block_command.h</a> Header file of SCSI Block Command (API)</li>
<li><a class="el" href="_mass___storage_2usb__scsi_8h.html" title="The header file of SCSI Block Command (SBC-3 &amp; SPC-4).">USBD/Mass_Storage/usb_scsi.h</a> Header file of SCSI Block Command (Protocol)</li>
<li>USBD/Mass_Storage/ram_disk.c RAM Disk related functions</li>
<li><a class="el" href="_mass___storage_2ram__disk_8h.html" title="The header file of RAM Disk.">USBD/Mass_Storage/ram_disk.h</a> Header file of RAM Disk</li>
<li>USBD/Mass_Storage/sd_disk.c SD Disk related functions</li>
<li><a class="el" href="sd__disk_8h.html" title="The header file of SD Disk.">USBD/Mass_Storage/sd_disk.h</a> Header file of SD Disk</li>
<li>USBD/Mass_Storage/spi_sd.c SD Card raw access function</li>
<li><a class="el" href="spi__sd_8h.html" title="The header file of SD Memory card driver.">USBD/Mass_Storage/spi_sd.h</a> Header file of SD Card</li>
</ul>
<dl class="user"><dt><b>Hardware and Software Environment:</b></dt><dd></dd></dl>
<p>This example can be run on HT32 Series development board. This example uses the following endpoints. </p>
<pre>
  Endpoint    Transfer Type         Buffer Length
  ========    ====================  ==============
  0           Control               64 bytes
  1           Bulk IN               64 bytes
  2           Bulk OUT              64 bytes
</pre><p>Please create a project according to the project_template and add the following extra source files into it.</p>
<ul>
<li>ht32_usbd_class.c</li>
<li>ht32_usbd_descriptor.c</li>
<li>usb_bulk_only_transport.c</li>
<li>usb_scsi_block_command.c</li>
<li>ram_disk.c</li>
<li>sd_disk.c</li>
<li>spi_sd.c</li>
</ul>
<p>This example code supports multiple LUN function which can used to access different media by single USB Mass Storage Device. A RAM Disk and SD Disk are supported by this example code. You can enable/disable both of them in "usb_bulk_only_transport.h" file. The number of LUN can also be changed in the same file.</p>
<dl class="user"><dt><b>Low Power mode:</b></dt><dd></dd></dl>
<p>For the convenient during debugging and evaluation stage, the <a class="el" href="example_2_c_k_c_u_2_h_s_i___auto_trim___by___u_s_b_2ht32f5xxxx__01__usbdconf_8h.html#a0cab6b5c44b15f5e60fdf62c5913d648">USBDCore_LowPower()</a> in the main.c is map to a null function by default. In the real product, you must map this function to the low power function of firmware library by setting USBDCORE_ENABLE_LOW_POWER as 1 (in the ht32fxxxx_usbdconf.h file).</p>
<dl class="user"><dt><b>USB Library debug mode:</b></dt><dd></dd></dl>
<p>For debug purpose, your can turn on the USB Library debug mode by setting "USBDCORE_DEBUG" definition value as 1 (which located at <a class="el" href="ht32__usbd__core_8h.html" title="The header file of standard protocol related function for HT32 USB Device Library.">ht32_usbd_core.h</a>). The debug message will be shown via the printf function to the UART or ITM interface according to the retarget setting of firmware library.</p>
<p>NOTE THAT USB DEBUG MODE DEGRADES THE PERFORMANCE AND MAY CAUSE USB ERROR UNDER SOME CONDITIONS.</p>
<p>You shall turn off the USB debug mode on your final application. We strongly recommend turn off the "Dump USB Debug data (USBDCORE_DEBUG_DATA)" option when you enable the USB debug mode and retarget the message to UART.</p>
<dl class="user"><dt><b>Firmware Disclaimer Information</b></dt><dd></dd></dl>
<p>1. The customer hereby acknowledges and agrees that the program technical documentation, including the code, which is supplied by Holtek Semiconductor Inc., (hereinafter referred to as "HOLTEK") is the proprietary and confidential intellectual property of HOLTEK, and is protected by copyright law and other intellectual property laws.</p>
<p>2. The customer hereby acknowledges and agrees that the program technical documentation, including the code, is confidential information belonging to HOLTEK, and must not be disclosed to any third parties other than HOLTEK and the customer.</p>
<p>3. The program technical documentation, including the code, is provided "as is" and for customer reference only. After delivery by HOLTEK, the customer shall use the program technical documentation, including the code, at their own risk. HOLTEK disclaims any expressed, implied or statutory warranties, including the warranties of merchantability, satisfactory quality and fitness for a particular purpose.</p>
<h2><center>Copyright (C) Holtek Semiconductor Inc. All rights reserved</center></h2>
</div></div>
<html xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta http-equiv=Content-Type content="text/html;">
<style>
<!--
p.MsoToc1, li.MsoToc1, div.MsoToc1 {
	font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:bold;
}
a:link, span.MsoHyperlink {
	color:blue;
	text-decoration:underline;
	text-underline:single;
}
a:visited, span.MsoHyperlinkFollowed {
	color:purple;
	text-decoration:underline;
	text-underline:single;
}
p.Title1, li.Title1, div.Title1 {
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman";
	font-weight:bold
}
-->
</style>
</head>

<body>
<div class=Section1 style='layout-grid:18.0pt'>
<div style='border:none;border-bottom:solid windowtext 1.0pt; padding:0cm 0cm 1.0pt 0cm'> </div>
<p align=center style='text-align:center'>
For complete information of HT32 Series 32-bit Microcontrollers platform visit
<a target="_blank" href="http://www.holtek.com/">Holtek Website</a></p>
<br>
<br>
</div>
</body>
</html>
